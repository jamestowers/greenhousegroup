{"version":3,"sources":["dropshop.coffee"],"names":[],"mappings":"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","file":"dropshop.js","sourceRoot":"/source/","sourcesContent":["class @Dropshop\n\n  constructor: ->\n    console.log '[Dropshop] Initialising...'\n    @$doc = $(document)\n    @$body = $('body')\n    @$hero = $('.hero-container')\n    @$navWrapper = $('#nav-overlay')\n    @init()\n\n  init: ->\n    FastClick.attach(document.body)\n    @setWidths()\n    @onPageLoad()\n\n  onPageFetch: ->\n    console.log '[Dropshop] Fetching page'\n\n  onPageLoad: ->\n    console.log '[Dropshop] onPageLoad'\n    @preloadBgImage( @$hero )\n    picturefill()\n    @setEventListeners()\n    @$body.removeClass 'nav-open show-nav'\n    @$allMods = $(\"[data-animate]\")\n\n  openNav: ->\n    @$body.addClass 'nav-open'\n    setTimeout( =>\n      @$body.addClass 'show-nav'\n    600 )\n\n\n  closeNav: ->\n    @$body.removeClass 'show-nav nav-open'\n\n  setWidths:->\n    console.log '[Dropshop] setting page dims'\n    @$navWrapper.css\n      height: window.dims.navWidth*3\n      width: window.dims.navWidth*3\n      top: -window.dims.navWidth*1.5\n      left: -window.dims.navWidth*0.5\n      \n    ###@sizes = \n      windowWidth: $(window).width()\n      windowHeight: $(window).height()\n      headerHeight: $('header.header').outerHeight()\n    @isMobile = @sizes.windowWidth < 580\n    @navWidth = if @sizes.windowWidth > @sizes.windowHeight then @sizes.windowWidth else @sizes.windowHeight\n    ###\n    \n      #width: @sizes.windowWidth\n\n    # Amend #wrapper height in stylesheet so no need to do it on each page load\n    #css = '.fullscreen { min-height : '+ window.dims.windowHeight + 'px }'\n    ###$sheet = document.getElementById('styles')\n    unless $sheet\n      head = document.head or document.getElementsByTagName('head')[0]\n      $sheet = document.createElement('style')\n      $sheet.appendChild(document.createTextNode(\"\")) # WebKit hack :(\n      $sheet.type = 'text/css'\n      $sheet.setAttribute(\"id\", \"styles\")\n      head.appendChild $sheet\n    $sheet = document.styleSheets[(document.styleSheets.length - 1)]\n    @addCSSRule($sheet, '.fullscreen', 'min-height :' + (window.dims.windowHeight) + 'px' )\n\n  addCSSRule: (sheet, selector, rules, index) ->\n    myrules = if sheet.cssRules then sheet.cssRules else sheet.rules\n    if myrules\n      sheet.crossdelete = if sheet.deleteRule then sheet.deleteRule else sheet.removeRule\n      i = 0\n      while i < myrules.length\n        if myrules[i].selectorText.toLowerCase().indexOf(selector) != -1\n          sheet.crossdelete i\n          i--\n        i++\n\n      if 'insertRule' of sheet\n        sheet.insertRule selector + '{' + rules + '}', index\n      else if 'addRule' of sheet\n        sheet.addRule selector, rules, index\n      return###\n\n\n  preloadBgImage: (parent)->\n    picture = $(parent).find('picture')\n    return unless picture.length\n    console.log '[Dropshop] lazy loading image'\n    el = $(picture)\n    img = el.find 'img'\n    imgLoad = imagesLoaded(el);\n    imgLoad.on 'progress', (instance, image) ->\n      if typeof image.img.currentSrc == 'undefined'\n        imgSrc = image.img.src\n      else\n        imgSrc = image.img.currentSrc\n\n      if image.isLoaded\n        $(image.img).parent().addClass 'loaded'\n        console.log 'Image ' + imgSrc + ' loaded'\n        dropshop.$body.removeClass('loading').addClass 'loaded'\n      \n\n  ######################\n  ## ON SCROLL\n  ######################\n  onScroll: ->\n    window.ticking = false\n    #unless dropshop.isMobile\n    if window.latestKnownScrollY > 100\n      dropshop.$body.addClass 'scrolled'\n    else\n      dropshop.$body.removeClass 'scrolled'\n\n    # Animate elements on scroll when visible\n    dropshop.$allMods.each (i, el) ->\n      el = $(el)\n      el.addClass 'animate' if el.visible(true)\n\n    return\n\n\n\n\n  ######################\n  ## EVENT LISTENERS\n  ######################\n  setEventListeners: ->\n    # Use this for setting new event listeners that need to be set after ajax page loads\n    console.log '[Dropshop] setting event listeners'\n    \n    @$doc.on 'click', 'a#menu-toggle', ->\n      if dropshop.$body.hasClass 'nav-open'\n        dropshop.closeNav()\n      else  \n        dropshop.openNav()\n      false\n\n    @$doc.on 'click', '#nav-header a', ->\n      dropshop.closeNav()\n\n"]}