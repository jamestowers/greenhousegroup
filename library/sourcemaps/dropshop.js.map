{"version":3,"sources":["dropshop.coffee"],"names":[],"mappings":"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","file":"dropshop.js","sourceRoot":"/source/","sourcesContent":["class @Dropshop\n\n  constructor: ->\n    console.log '[Dropshop] Initialising...'\n    @$doc = $(document)\n    @$body = $('body')\n    @$navWrapper = $('#nav-overlay')\n    @init()\n\n  init: ->\n    FastClick.attach(document.body)\n    @setWidths()\n    @onPageLoad()\n\n  onPageFetch: ->\n    console.log '[Dropshop] Fetching page'\n\n  onPageLoad: ->\n    console.log '[Dropshop] onPageLoad'\n    @preloadBgImage()\n    picturefill()\n    @setEventListeners()\n    @$body.removeClass 'nav-open show-nav'\n    @$allMods = $(\"[data-animate]\")\n\n  openNav: ->\n    @$body.addClass 'nav-open'\n    setTimeout( =>\n      @$body.addClass 'show-nav'\n    600 )\n\n\n  closeNav: ->\n    @$body.removeClass 'show-nav nav-open'\n\n  setWidths:->\n    console.log '[Dropshop] setting page dims'\n    @sizes = \n      windowWidth: $(window).width()\n      windowHeight: $(window).height()\n      headerHeight: $('header.header').outerHeight()\n    @isMobile = @sizes.windowWidth < 580\n    @navWidth = if @sizes.windowWidth > @sizes.windowHeight then @sizes.windowWidth else @sizes.windowHeight\n\n    @$navWrapper.css\n      height: @navWidth*3\n      width: @navWidth*3\n      top: -@navWidth*1.5\n      left: -@navWidth*0.5\n      #width: @sizes.windowWidth\n\n    # Amend #wrapper height in stylesheet so no need to do it on each page load\n    css = '.fullscreen { min-height : '+ @sizes.windowHeight + 'px }'\n    $sheet = document.getElementById('styles')\n    unless $sheet\n      head = document.head or document.getElementsByTagName('head')[0]\n      $sheet = document.createElement('style')\n      $sheet.appendChild(document.createTextNode(\"\")) # WebKit hack :(\n      $sheet.type = 'text/css'\n      $sheet.setAttribute(\"id\", \"styles\")\n      head.appendChild $sheet\n    $sheet = document.styleSheets[(document.styleSheets.length - 1)]\n    @addCSSRule($sheet, '.fullscreen', 'min-height :' + (@sizes.windowHeight) + 'px' )\n\n  addCSSRule: (sheet, selector, rules, index) ->\n    myrules = if sheet.cssRules then sheet.cssRules else sheet.rules\n    if myrules\n      sheet.crossdelete = if sheet.deleteRule then sheet.deleteRule else sheet.removeRule\n      i = 0\n      while i < myrules.length\n        if myrules[i].selectorText.toLowerCase().indexOf(selector) != -1\n          sheet.crossdelete i\n          i--\n        i++\n\n      if 'insertRule' of sheet\n        sheet.insertRule selector + '{' + rules + '}', index\n      else if 'addRule' of sheet\n        sheet.addRule selector, rules, index\n      return\n\n\n  preloadBgImage: ->\n    picture = $('.fullscreen picture')\n    return unless picture.length\n    picture.each (i, el)->\n      console.log '[App] loading background image'\n      el = $(el)\n      img = el.find 'img'\n      imgLoad = imagesLoaded(el);\n      imgLoad.on 'progress', (instance, image) ->\n        if typeof image.img.currentSrc == 'undefined'\n          imgSrc = image.img.src\n        else\n          imgSrc = image.img.currentSrc\n        #result = if image.isLoaded then 'loaded' else 'broken'\n        if image.isLoaded\n          $(image.img).parent().addClass 'loaded'\n          console.log 'Image ' + imgSrc + ' loaded'\n\n\n  ######################\n  ## ON SCROLL\n  ######################\n  onScroll: ->\n    window.ticking = false\n    #unless dropshop.isMobile\n    if window.latestKnownScrollY > dropshop.sizes.headerHeight\n      dropshop.$body.addClass 'scrolled'\n    else\n      dropshop.$body.removeClass 'scrolled'\n\n    # Animate elements on scroll when visible\n    dropshop.$allMods.each (i, el) ->\n      el = $(el)\n      el.addClass 'animate' if el.visible(true)\n    return\n\n\n\n\n  ######################\n  ## EVENT LISTENERS\n  ######################\n  setEventListeners: ->\n    # Use this for setting new event listeners that need to be set after ajax page loads\n    console.log '[Dropshop] setting event listeners'\n    \n    @$doc.on 'click', 'a#menu-toggle', ->\n      if dropshop.$body.hasClass 'nav-open'\n        dropshop.closeNav()\n      else  \n        dropshop.openNav()\n      false\n\n"]}